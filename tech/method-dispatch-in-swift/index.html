<!DOCTYPE html>
<html lang='en'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Method dispatch is a term referring to mechanisms by which the program determines which operation should be executed (by operation, I mean a set of instructions). There are times we expect a method behavior to be determined only at runtime. This motivation give rise to different mechanisms of dispatching a method, each of which has its own pros and cons.'>
<meta name='theme-color' content='#0067a7'>

<meta property='og:title' content='Method dispatch in Swift ‚Ä¢ Thuyen&#39;s corner'>
<meta property='og:description' content='Method dispatch is a term referring to mechanisms by which the program determines which operation should be executed (by operation, I mean a set of instructions). There are times we expect a method behavior to be determined only at runtime. This motivation give rise to different mechanisms of dispatching a method, each of which has its own pros and cons.'>
<meta property='og:url' content='https://trinhngocthuyen.github.io/tech/method-dispatch-in-swift/'>
<meta property='og:site_name' content='Thuyen&#39;s corner'>
<meta property='og:type' content='article'><meta property='article:section' content='tech'><meta property='article:tag' content='ios'><meta property='article:tag' content='swift'><meta property='article:tag' content='programming'><meta property='article:tag' content='method-dispatch'><meta property='article:tag' content='optimization'><meta property='article:published_time' content='2017-09-25T00:00:00Z'/><meta property='article:modified_time' content='2017-09-25T00:00:00Z'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.55.3" />

  <title>Method dispatch in Swift ‚Ä¢ Thuyen&#39;s corner</title>
  <link rel='canonical' href='https://trinhngocthuyen.github.io/tech/method-dispatch-in-swift/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.d751652e.css'><link rel='stylesheet' href='/css/custom.css'><link rel='stylesheet' href='/css/syntax.css'><style>
:root{--color-accent:#0067a7;}
</style>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-69597239-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  

</head>
<body class='page type-tech layout-post has-sidebar'>

  <div class='site'><div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <h2 class='title site-title '>
      <a href='/'>
      Thuyen&#39;s corner
      </a>
    </h2>
    <div class='desc'>
    
    </div>
  </header>

</section>
<section class='widget widget-search sep-after'>
  <header>
    <h4 class='title widget-title'>Search</h4>
  </header>

  <form action='/search' id='search-form' class='search-form'>
    <label>
      <span class='screen-reader-text'>Search</span>
      <input id='search-term' class='search-term' type='search' name='q' placeholder='Search&hellip;'>
    </label></form>

</section>
<section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud no-shuffle'><li>
        <a href='/tags/algebra/' style='font-size:1em'>algebra</a>
      </li><li>
        <a href='/tags/architecture/' style='font-size:1em'>architecture</a>
      </li><li>
        <a href='/tags/astrology/' style='font-size:1em'>astrology</a>
      </li><li>
        <a href='/tags/book-review/' style='font-size:1em'>book-review</a>
      </li><li>
        <a href='/tags/brain-exercises/' style='font-size:1.1176470588235294em'>brain-exercises</a>
      </li><li>
        <a href='/tags/command-line/' style='font-size:1em'>command-line</a>
      </li><li>
        <a href='/tags/compiler/' style='font-size:1em'>compiler</a>
      </li><li>
        <a href='/tags/config/' style='font-size:1em'>config</a>
      </li><li>
        <a href='/tags/creative-thinking/' style='font-size:1.0588235294117647em'>creative-thinking</a>
      </li><li>
        <a href='/tags/decision-making/' style='font-size:1em'>decision-making</a>
      </li><li>
        <a href='/tags/expectation/' style='font-size:1em'>expectation</a>
      </li><li>
        <a href='/tags/garbage-collection/' style='font-size:1em'>garbage-collection</a>
      </li><li>
        <a href='/tags/image-processing/' style='font-size:1em'>image-processing</a>
      </li><li>
        <a href='/tags/ios/' style='font-size:2em'>ios</a>
      </li><li>
        <a href='/tags/logic/' style='font-size:1.0588235294117647em'>logic</a>
      </li><li>
        <a href='/tags/markov-chain/' style='font-size:1em'>markov-chain</a>
      </li><li>
        <a href='/tags/maths/' style='font-size:1.1764705882352942em'>maths</a>
      </li><li>
        <a href='/tags/method-dispatch/' style='font-size:1em'>method-dispatch</a>
      </li><li>
        <a href='/tags/mvvm/' style='font-size:1em'>mvvm</a>
      </li><li>
        <a href='/tags/network/' style='font-size:1em'>network</a>
      </li><li>
        <a href='/tags/neural-networks/' style='font-size:1em'>neural-networks</a>
      </li><li>
        <a href='/tags/optimization/' style='font-size:1.0588235294117647em'>optimization</a>
      </li><li>
        <a href='/tags/paradox/' style='font-size:1em'>paradox</a>
      </li><li>
        <a href='/tags/probability/' style='font-size:1.2352941176470589em'>probability</a>
      </li><li>
        <a href='/tags/problem-solving/' style='font-size:1.1176470588235294em'>problem-solving</a>
      </li><li>
        <a href='/tags/programming/' style='font-size:1.1176470588235294em'>programming</a>
      </li><li>
        <a href='/tags/psychological-efffects/' style='font-size:1em'>psychological-efffects</a>
      </li><li>
        <a href='/tags/questioning/' style='font-size:1em'>questioning</a>
      </li><li>
        <a href='/tags/reading/' style='font-size:1em'>reading</a>
      </li><li>
        <a href='/tags/reasoning/' style='font-size:1.1176470588235294em'>reasoning</a>
      </li><li>
        <a href='/tags/resolution/' style='font-size:1em'>resolution</a>
      </li><li>
        <a href='/tags/retrospection/' style='font-size:1em'>retrospection</a>
      </li><li>
        <a href='/tags/retrospective/' style='font-size:1em'>retrospective</a>
      </li><li>
        <a href='/tags/science/' style='font-size:1.0588235294117647em'>science</a>
      </li><li>
        <a href='/tags/statistics/' style='font-size:1.1764705882352942em'>statistics</a>
      </li><li>
        <a href='/tags/stub/' style='font-size:1em'>stub</a>
      </li><li>
        <a href='/tags/swift/' style='font-size:1.3529411764705883em'>swift</a>
      </li><li>
        <a href='/tags/swizzle/' style='font-size:1em'>swizzle</a>
      </li><li>
        <a href='/tags/testing/' style='font-size:1em'>testing</a>
      </li><li>
        <a href='/tags/travel/' style='font-size:1.3529411764705883em'>travel</a>
      </li><li>
        <a href='/tags/triz/' style='font-size:1.0588235294117647em'>triz</a>
      </li><li>
        <a href='/tags/ux/' style='font-size:1em'>ux</a>
      </li><li>
        <a href='/tags/xcode/' style='font-size:1em'>xcode</a>
      </li></ul>
</div>


</section>
</div>

  <div class='sidebar-overlay'></div>
</div><div class='main'><nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    <a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="3" y1="12" x2="21" y2="12" />
  <line x1="3" y1="6" x2="21" y2="6" />
  <line x1="3" y1="18" x2="21" y2="18" />
  
</svg>
</span>
  <span class='close'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
  
</svg>
</span>
</button>
    <ul><li class='item'>
        <a href='/tech/'>Tech</a>
      </li><li class='item'>
        <a href='/reasoning/'>Reasoning</a>
      </li><li class='item'>
        <a href='/misc/'>Misc</a>
      </li><li class='item'>
        <a href='/reading/'>Reading</a>
      </li><li class='item'>
        <a href='/about/'>About</a>
      </li></ul>
  </div>
</nav><div class='header-widgets'>
        <div class='container'>
    
    <style>.widget-breadcrumbs li:after{content:'‚â´'}</style>
  <section class='widget widget-breadcrumbs sep-after'>
    <nav id='breadcrumbs'>
      <ol><li><a href='/'>üè° Home</a></li><li><a href='/tech/'>Tech</a></li><li><span>Method dispatch in Swift</span></li></ol>
    </nav>
  </section></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>Thuyen&#39;s corner</p><p class='desc site-desc'></p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Method dispatch in Swift</h1>
      

    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2017-09-25T00:00:00Z'>2017, Sep 25</time>
</span>

  
  

</div>


  </div>
</header>

  
  
<details class='container entry-toc'>
  <summary class='title'>
    <span>Table of Contents</span>
  </summary>
  <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#static-dispatch">Static dispatch</a></li>
<li><a href="#dynamic-dispatch">Dynamic dispatch</a>
<ul>
<li><a href="#table-dispatch">Table dispatch</a></li>
<li><a href="#message-dispatch">Message dispatch</a></li>
</ul></li>
<li><a href="#swift-what-is-what">Swift: What is what?</a>
<ul>
<li><a href="#methodology-to-determine-dispatch-mechanism">Methodology to determine dispatch mechanism</a></li>
<li><a href="#trivial-cases">Trivial cases</a></li>
<li><a href="#other-cases">Other cases</a></li>
<li><a href="#what-are-the-principles">What are the principles?</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#reference">Reference</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
</details>


  <div class='container entry-content'>
  

<p>Method dispatch is a term referring to mechanisms by which the program determines which operation should be executed (by operation, I mean a set of instructions). There are times we expect a method behavior to be determined only at runtime. This motivation give rise to different mechanisms of dispatching a method, each of which has its own pros and cons.</p>

<h3 id="static-dispatch">Static dispatch</h3>

<ul>
<li>Sometimes called <em>direct dispatch</em>.</li>
<li>If a method is statically dispatched, the compiler could be able to locate where the instructions are, at compile time. Therefore, when such function is called, the system jumps directly to the memory address of this function to perform the operation. This direct behavior results in very fast execution, and also allows the compiler to perform various kinds of optimizations such as inlining. In fact, due to the huge performance gains, there is a phase in the compilation pipeline in which the compiler attempts to make functions static if applicable. This optimization is known as <strong>devirtualization</strong>.</li>
</ul>

<h3 id="dynamic-dispatch">Dynamic dispatch</h3>

<ul>
<li>With this approach, the program does not know which implementation to choose until runtime.</li>
<li>While <em>static dispatch</em> is super lightweight, it limits flexibility, especially when it comes to polymorphism. That is why <em>dynamic dispatch</em> is widely supported by OOP languages.</li>
<li>Every language has its own mechanisms to support dynamic dispatch. Swift provides 2 ways to achieve dynamism: <strong>table dispatch</strong> and <strong>message dispatch</strong>.</li>
</ul>

<h4 id="table-dispatch">Table dispatch</h4>

<ul>
<li>This is the most common choice provided in compiled languages. With this method, a class is associated with a so-called <strong>virtual table</strong> which comprises an array of function pointers to the real implementation correponding to that class.</li>
<li>Note that the vtable is constructed at compile time. Thus, there are only two additional instructions (read and jump) as compared to static dispatch. So the dispatch should be theoretically pretty fast.</li>
</ul>

<h4 id="message-dispatch">Message dispatch</h4>

<ul>
<li>In fact, it is Objective-C that provides this mechanism (sometimes, it is referred as <a href="https://en.wikipedia.org/wiki/Message_passing"><em>message passing</em></a>) and Swift code just uses the Objective-C runtime lib. Every time an Objective-C method is called, the invocation is passed to <code>objc_msgSend</code> which handles the look ups. Technically, the process starts from the given class and iterates the class hierarchy to pull out the implementation.</li>
<li>Unlike table dispatch, the <em>message passing dictionary</em> could be modified at runtime, enabling us to adjust the program behaviors while running. Method swizzling is one of the most popular technique, by taking advantage of this special feature.</li>
<li><em>Message dispatch</em> is the most dynamic among the three. As a trade off, the cost of resolving implementation could be a little expensive though the lookup performance is guarded by caching mechanism.</li>
<li>This mechanism is a keystone of Cocoa frameworks. Looking at the source of code Swift, you will see that KVO is implemented using swizzling.</li>
</ul>

<h3 id="swift-what-is-what">Swift: What is what?</h3>

<blockquote>
<p>Given a function, what kind of dispatch is it using? Where is the proof?</p>
</blockquote>

<h4 id="methodology-to-determine-dispatch-mechanism">Methodology to determine dispatch mechanism</h4>

<p>As a skeptic, I am more interested in the second part of the question. It is easy to come up with a hypothesis but testing it is not straightforward all the time. After hours googling, I happened to know the <a href="https://github.com/apple/swift/blob/master/docs/SIL.rst">SIL documentation</a> which reasonably explains the presence of dispatch strategies. Here is a brief summary:</p>

<p>(1) If a function uses table dispatch, it appears in the <code>vtable</code> (or <code>witness_table</code> for protocols).</p>
<div class="highlight"><pre class="chroma">sil_vtable Animal {
	#Animal.makeSound!1: (Animal) -&gt; () -&gt; () : main.Animal.makeSound() -&gt; ()	// Animal.makeSound()
  ......
}</pre></div>
<p>(2) If a function is dispatched via message, the keyword <code>volatile</code> should be present in the invocation. Also, you will find the two marker <code>foreign</code> and <code>objc_method</code>, indicating that the function is invoked using Objective-C runtime. Refer: <a href="https://github.com/apple/swift/blob/master/docs/SIL.rst#dynamic-dispatch">here</a>.</p>
<div class="highlight"><pre class="chroma">%14 = class_method [volatile] %13 : $Dog, #Dog.beWild!1.foreign : (Dog) -&gt; () -&gt; (), $@convention(objc_method) (Dog) -&gt; () // user: %15</pre></div>
<p>(3) If there is no evidence of the two cases above, the answer is <em>static dispatch</em>.</p>

<!-- As the SIL is usually lengthy, you are recommended to read it yourself. -->

<h4 id="trivial-cases">Trivial cases</h4>

<ul>
<li>First of all, functions of structs or any value types must be statically dispatched. This makes sense because they could never be overriden.</li>
<li>Explicitly enforced:

<ul>
<li>Functions with <code>final</code> keyword are also statically dispatched.</li>
<li>Functions with <code>dynamic</code> are invoked via message passing. Piror to Swift 4, a function with <code>dynamic</code> modifier is implicitly visible to Objective-C. Meanwhile Swift 4 requires you to explicitly declare it with <code>@objc</code> attribute.</li>
</ul></li>
<li>Ordinary extensions (without <code>final</code>, <code>dynamic</code>, <code>@objc</code>) are directly dispatched. Now, recall a compiled error you may once experienced: <em>declarations in extensions cannot override yet</em>. It&rsquo;s because those functions, of course, follow static dispatch.<br>
You may ask: <em>&ldquo;What if I make those extensions dynamic?&rdquo;</em>. You got the point! If an extension is dynamic, it can be overriden üòá.</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-swift" data-lang="swift"><span class="kd">extension</span> <span class="nc">Animal</span> <span class="p">{</span>
	<span class="kd">func</span> <span class="nf">eat</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
	<span class="kr">@objc</span> <span class="kr">dynamic</span> <span class="kd">func</span> <span class="nf">getWild</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nc">Dog</span><span class="p">:</span> <span class="n">Animal</span> <span class="p">{</span>
	<span class="kr">override</span> <span class="kd">func</span> <span class="nf">eat</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>	<span class="c1">// Compiled error!</span>
	<span class="kr">@objc</span> <span class="kr">dynamic</span> <span class="kr">override</span> <span class="kd">func</span> <span class="nf">getWild</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>	<span class="c1">// Ok :)</span>
<span class="p">}</span></code></pre></div>
<h4 id="other-cases">Other cases</h4>
<div class="highlight"><pre class="chroma"><code class="language-swift" data-lang="swift"><span class="kd">protocol</span> <span class="nc">Noisy</span> <span class="p">{</span>
	<span class="kd">func</span> <span class="nf">makeNoise</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="nb">Int</span>	<span class="c1">// TABLE</span>
<span class="p">}</span>
<span class="kd">extension</span> <span class="nc">Noisy</span> <span class="p">{</span>
	<span class="kd">func</span> <span class="nf">makeNoise</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="nb">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">0</span> <span class="p">}</span>	<span class="c1">// TABLE</span>
	<span class="kd">func</span> <span class="nf">isAnnoying</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="nb">Bool</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">true</span> <span class="p">}</span>	<span class="c1">// STATIC</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nc">Animal</span><span class="p">:</span> <span class="n">Noisy</span> <span class="p">{</span>
	<span class="kd">func</span> <span class="nf">makeNoise</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="nb">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">1</span> <span class="p">}</span>	<span class="c1">// TABLE</span>
	<span class="kd">func</span> <span class="nf">isAnnoying</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="nb">Bool</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">false</span> <span class="p">}</span> <span class="c1">// TABLE</span>
	<span class="kr">@objc</span> <span class="kd">func</span> <span class="nf">sleep</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>	<span class="c1">// Still TABLE</span>
<span class="p">}</span>
<span class="kd">extension</span> <span class="nc">Animal</span> <span class="p">{</span>
	<span class="kd">func</span> <span class="nf">eat</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>	<span class="c1">// STATIC</span>
	<span class="kr">@objc</span> <span class="kd">func</span> <span class="nf">getWild</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>	<span class="c1">// MESSAGE</span>
<span class="p">}</span></code></pre></div>
<ul>
<li><code>Noisy.isAnnoying()</code>, and <code>Animal.getWild()</code> are statically dispatched since they are extensions.</li>
<li><code>Noisy.makeNoise()</code> uses table dispatch despite having the default implementation.</li>
<li>We have to be careful with <code>isAnnoying()</code>. Consider the two usages below. <code>animal2.isAnnoying()</code> picks the implementation of the protocol extension (because it&rsquo;s a direct method and no lookup is needed). Using in such way could be a source of bugs üò±.</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-swift" data-lang="swift"><span class="kd">let</span> <span class="nv">animal1</span> <span class="p">=</span> <span class="n">Animal</span><span class="p">()</span>
<span class="bp">print</span><span class="p">(</span><span class="n">animal1</span><span class="p">.</span><span class="n">isAnnoying</span><span class="p">())</span>	<span class="c1">// Value: false</span>
<span class="kd">let</span> <span class="nv">animal2</span><span class="p">:</span> <span class="n">Noisy</span> <span class="p">=</span> <span class="n">Animal</span><span class="p">()</span>
<span class="bp">print</span><span class="p">(</span><span class="n">animal2</span><span class="p">.</span><span class="n">isAnnoying</span><span class="p">())</span>	<span class="c1">// Value: true</span></code></pre></div>
<ul>
<li>On the other hand, <code>animal1.makeNoise()</code> and <code>animal2.makeNoise()</code> produce the same result because protocol requirements are resolved by table lookups.</li>
<li>The <code>@objc</code> annotation in <code>@objc func sleep()</code> means that the function is visible to Objective-C. It does not necessarily imply that the process will choose the Objective-C method to execute. From the SIL of the function call (see below), we could see the term <code>$@convention(method)</code> which implies that the Swift method is chosen over the objc method.</li>
</ul>
<div class="highlight"><pre class="chroma">%9 = class_method %8 : $Animal, #Animal.sleep!1 : (Animal) -&gt; () -&gt; (), $@convention(method) (@guaranteed Animal) -&gt; () // user: %10</pre></div>
<h4 id="what-are-the-principles">What are the principles?</h4>

<ul>
<li><em>Direct dispatch</em> is prioritized.</li>
<li>If overriding is needed, <em>table dispatch</em> is the next candidate.</li>
<li>Need both overriding and visibility to Objective-C? Then <em>message dispatch</em>.</li>
</ul>

<p>Another key take-away is that explicity is better. Implicit inference (like extensions with <code>@objc</code>) is subject to change.</p>

<p>Here is the summary of some common cases. You are recommended to double check by reading the SIL generated.</p>

<table>
<thead>
<tr>
<th></th>
<th align="center">Direct</th>
<th align="center">Table</th>
<th align="center">Message</th>
</tr>
</thead>

<tbody>
<tr>
<td><strong>Explicitly enforced</strong></td>
<td align="center"><code>final</code>, <code>static</code></td>
<td align="center">&mdash;</td>
<td align="center"><code>dynamic</code></td>
</tr>

<tr>
<td><strong>Value type</strong></td>
<td align="center">all methods</td>
<td align="center">&mdash;</td>
<td align="center">&mdash;</td>
</tr>

<tr>
<td><strong>Protocols</strong></td>
<td align="center">extensions</td>
<td align="center">initial declaration</td>
<td align="center">&mdash;</td>
</tr>

<tr>
<td><strong>Class</strong></td>
<td align="center">extensions</td>
<td align="center">initial declaration</td>
<td align="center">extensions with <code>@objc</code></td>
</tr>
</tbody>
</table>

<figcaption><em>Table 1</em>. Summary of method dispatch in Swift (reading from top to bottom). Note that some cases such as <em>class extensions with</em> <code>@objc dynamic</code> is already mentioned aboved in <em>explicitly enforced</em>. Many blog posts divide classes into 2 groups: NSObject subclasses vs. (regular) classes. Though NSObject inherits a number of methods that were written on top of Objective-C runtime, I see no reason to separate them.</figcaption>

<h3 id="conclusion">Conclusion</h3>

<p>In this post, we got to know what method dispatch is and different types of dispatch in Swift. We dived into some examples to understand how Swift resolves a specific function. Also, by reading the SIL, we could be able to collect proofs for an assumption on which dispatch a function should follow.</p>

<ul>
<li><em>Static dispatch</em> is greate because of its performance. That is why Swift is swift (as compared to Objective-C, a dynamic language).</li>
<li>While <em>message dispatch</em> seems to be less performant, it offers great flexibility enabling a bunch of cool techniques.</li>
<li>Understanding <em>method dispatch</em> is vitally important. Not only does it help you write more optimized code but also you could avoid a few strange bugs.</li>
<li>Among these mentioned above, we have put aside the optimization of the compiler. The capacity of the code to be optimized depends greatly on how we write code :).</li>
</ul>

<p>Finally, things might be different in later Swift versions. Don&rsquo;t forget to check the validity of this post üòá.</p>

<h3 id="reference">Reference</h3>

<ol>
<li><a href="https://www.raizlabs.com/dev/2016/12/swift-method-dispatch">Method Dispatch in Swift - by Brian King</a></li>
<li><a href="http://www.buckleyisms.com/home/2014/6/16/the-case-for-message-passing-in-swift.html">The Case for Message Passing in Swift - by Michael Buckley</a></li>
<li><a href="https://dev.srdanstanic.com/ios/swift/2017/02/10/swift-dynamic-keyword">[swift] Dynamic keyword - by Srdan</a></li>
<li><a href="https://github.com/apple/swift/blob/master/docs/SIL.rst">Swift Intermediate Language (SIL)</a></li>
<li><a href="https://www.mikeash.com/pyblog/friday-qa-2014-07-04-secrets-of-swifts-speed.html">Friday Q&amp;A 2014-07-04: Secrets of Swift&rsquo;s Speed</a></li>
<li><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Declarations.html#//apple_ref/swift/grammar/declaration-modifiers">The Swift Programming Language (Swift 4): Declaration Modifiers</a></li>
</ol>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='categories'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22,19a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V5A2,2,0,0,1,4,3H9l2,3h9a2,2,0,0,1,2,2Z"/>
  
</svg>
<span class='screen-reader-text'>Categories: </span><a class='category' href='/categories/tech/'>Tech</a></div>
<div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/ios/'>ios</a> <a class='tag' href='/tags/swift/'>swift</a> <a class='tag' href='/tags/programming/'>programming</a> <a class='tag' href='/tags/method-dispatch/'>method-dispatch</a> <a class='tag' href='/tags/optimization/'>optimization</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/tech/how-a-swift-file-is-compiled/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>How a Swift file is compiled</a>
    </div><div class='next-entry sep-before'>
      <a href='/tech/method-swizzling-what-why-and-how/'>
        <span class='screen-reader-text'>Next post: </span>Method Swizzling: What, Why and How<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>


<section id='comments' class='comments'>
  <div class='container sep-before'>
    
    
    <div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.3"></script>
<div class="share">
  <div class="fb-like" data-href="https://trinhngocthuyen.github.io/tech/method-dispatch-in-swift/" data-width="" data-layout="standard" data-action="like" data-size="small" data-share="true"></div>
</div>


    
    
    <div class='comments-area'>
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "trinhngocthuyen-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </div>
  </div>
</section>


      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/trinhngocthuyen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/trinhngocthuyen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li><li>
        <a href='mailto:trinhngocthuyen@gmail.com' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Contact via Email</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
  <polyline points="22,6 12,13 2,6"/>
  
</svg>
</a>
      </li><li>
        <a href='https://linkedin.com/in/thuyen-trinh' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Linkedin account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
  <rect x="2" y="9" width="4" height="12"/>
  <circle cx="4" cy="4" r="2"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section><div class='copyright'>
  <p></p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.69694257.js'></script>

</body>

</html>

